{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"bt-trx Dokumentation Aktuelle Firmware-Version: 0.2.0 Diese Dokumentation ist unter der CC BY-SA 4.0 lizensiert.","title":"Startseite"},{"location":"fehlerbehebung/","text":"","title":"Fehlerbehebung"},{"location":"10_Allgemein/Kompatibilit\u00e4tsliste/","text":"Kompatibilit\u00e4tsliste Stand: Firmware v0.2.0 Wir freuen uns \u00fcber Erfahrungsberichte mit hier gelisteten oder neuen Modellen! Autoradios Integrierte Radios Typ Baujahr Funktioniert? Kommentar Citro\u00ebn C5 2019 ja Fiat Fiorino ja Die vom Fahrzeug vorgegebene PIN muss in der bt-trx Firmware eingestellt werden. (z.B. SET BT AUTH * 1234 ) Ford Ranger ja Jeep Wrangler Work in Progress Mercedes GLC 2017 ja Mini Cooper 2009 ja Pineingabe am Fahrzeug notwendig (bei bt-trx voreingestellt: 0000) Nissan Qashqai ja Die vom Fahrzeug vorgegebene PIN muss in der bt-trx Firmware eingestellt werden. (z.B. SET BT AUTH * 1234 ) SEAT Ateca Work in Progress Tesla Model S ja VW Caddy 2014 ja Radio: RCD330+ VW Passat 2017 ja Zubeh\u00f6rradios Typ Funktioniert? Kommentar Kenwood DMX7017DABS ja -- Kenwood KDC-X7200DAB ja -- Pioneer AVH-X3500DAB ja -- Pioneer AVH-Z5100DAB ja -- Funkger\u00e4te Typ Funktioniert? Kommentar Anytone AT-D878UV ja -- Kenwood TM-D700 ja -- Kenwood TM-D710 ja -- Tytera MD-380 / MD-390 ja -- Wouxun KG-UV6D ja --","title":"Kompatibilit\u00e4tsliste"},{"location":"10_Allgemein/Kompatibilit\u00e4tsliste/#kompatibilitatsliste","text":"Stand: Firmware v0.2.0 Wir freuen uns \u00fcber Erfahrungsberichte mit hier gelisteten oder neuen Modellen!","title":"Kompatibilit\u00e4tsliste"},{"location":"10_Allgemein/Kompatibilit\u00e4tsliste/#autoradios","text":"","title":"Autoradios"},{"location":"10_Allgemein/Kompatibilit\u00e4tsliste/#integrierte-radios","text":"Typ Baujahr Funktioniert? Kommentar Citro\u00ebn C5 2019 ja Fiat Fiorino ja Die vom Fahrzeug vorgegebene PIN muss in der bt-trx Firmware eingestellt werden. (z.B. SET BT AUTH * 1234 ) Ford Ranger ja Jeep Wrangler Work in Progress Mercedes GLC 2017 ja Mini Cooper 2009 ja Pineingabe am Fahrzeug notwendig (bei bt-trx voreingestellt: 0000) Nissan Qashqai ja Die vom Fahrzeug vorgegebene PIN muss in der bt-trx Firmware eingestellt werden. (z.B. SET BT AUTH * 1234 ) SEAT Ateca Work in Progress Tesla Model S ja VW Caddy 2014 ja Radio: RCD330+ VW Passat 2017 ja","title":"Integrierte Radios"},{"location":"10_Allgemein/Kompatibilit\u00e4tsliste/#zubehorradios","text":"Typ Funktioniert? Kommentar Kenwood DMX7017DABS ja -- Kenwood KDC-X7200DAB ja -- Pioneer AVH-X3500DAB ja -- Pioneer AVH-Z5100DAB ja --","title":"Zubeh\u00f6rradios"},{"location":"10_Allgemein/Kompatibilit\u00e4tsliste/#funkgerate","text":"Typ Funktioniert? Kommentar Anytone AT-D878UV ja -- Kenwood TM-D700 ja -- Kenwood TM-D710 ja -- Tytera MD-380 / MD-390 ja -- Wouxun KG-UV6D ja --","title":"Funkger\u00e4te"},{"location":"10_Allgemein/Stromverbrauch/","text":"Stromverbrauch Stand: Firmware v0.2.0 Aktuell sind noch keine stromsparenden Ma\u00dfnahmen in der Firmware integriert. Die Leistungsaufnahme betr\u00e4gt ca. 500 mW. Die Messungen f\u00fcr 5 V, 12 V, 13.8 V wurden \u00fcber die RJ45 Buchse durchgef\u00fchrt. Bei ESP32-USB wurde bt-trx \u00fcber USB versorgt. Modus 5 V 12 V 13.8 V ESP32-USB (5.1V) Booten -- 101 -- -- Idle 69 70 73 74 Idle + Wifi -- 147 -- -- BT Suche 94 96 97 100 BT Verbunden 78 81 82 86 Telefongespr\u00e4ch 100 101 102 106 Alle Werte in mA","title":"Stromverbrauch"},{"location":"10_Allgemein/Stromverbrauch/#stromverbrauch","text":"Stand: Firmware v0.2.0 Aktuell sind noch keine stromsparenden Ma\u00dfnahmen in der Firmware integriert. Die Leistungsaufnahme betr\u00e4gt ca. 500 mW. Die Messungen f\u00fcr 5 V, 12 V, 13.8 V wurden \u00fcber die RJ45 Buchse durchgef\u00fchrt. Bei ESP32-USB wurde bt-trx \u00fcber USB versorgt. Modus 5 V 12 V 13.8 V ESP32-USB (5.1V) Booten -- 101 -- -- Idle 69 70 73 74 Idle + Wifi -- 147 -- -- BT Suche 94 96 97 100 BT Verbunden 78 81 82 86 Telefongespr\u00e4ch 100 101 102 106 Alle Werte in mA","title":"Stromverbrauch"},{"location":"20_Zusammenbau/Anschlusskabel/","text":"Anschlusskabel Zum Anschluss des bt-trx an das Funkger\u00e4t empfiehlt es sich, z.B. aus einem Netzwerkkabel mit RJ45 Stecker ein Adapterkabel zu bauen. Da die Funkger\u00e4te an der Mikrofonbuchse nicht immer eine passende Versorgungsspannung bzw. -leistung liefern, kann es erforderlich sein, die Spannung extern zuzuf\u00fchren (z.B. \u00fcber Zigarettenanz\u00fcnder). bt-trx bietet zwei M\u00f6glichkeiten um mit Spannung versorgt zu werden: Buchse J5: V_IN (Pin 7)/GND (Pin 8), 5...15 V DC, oder Mikro-USB Buchse des ESP32 Informationen zum Stromverbrauch gibt es hier . In den folgenden Tabellen werden immer RJ45 Stecker mit T568B Belegung angenommen! Belegung RJ45 Buchse (J1) Pin Signal bt-trx Farbe K\u00fcrzel 1 CAT_TX orange/wei\u00df o 2 AUDIO_IN_B orange O 3 CAT_RX gr\u00fcn/wei\u00df g 4 AUDIO_IN_A blau B 5 PTT blau/wei\u00df b 6 AUDIO_OUT gr\u00fcn G 7 V_IN (5...15 V DC) braun/wei\u00df br 8 GND braun BR Farbkodierung: EIA/TIA 568B Belegung Funkger\u00e4t Hier ist eine Sammlung der Steckerbelegungen diverser Funkger\u00e4te und der entsprechenden Signale des bt-trx. Handfunkger\u00e4te (2.5mm und 3.5 mm Klinke) z.B. Anytone, Baofeng, Kenwood, Wouxun Kontakt Signal Farbe Stecker J5 Signal bt-trx 3.5 mm Tip +5V -- -- 3.5 mm Ring MIC+ G AUDIO_OUT 3.5 mm Sleeve MIC-/PTT b PTT 2.5 mm Tip SPK+ B AUDIO_IN_A 2.5 mm Ring Prog -- -- 2.5 mm Sleeve SPK-/PTT BR GND Die Spannungsversorgung des bt-trx (br (+)/BR (-)) muss extern zugef\u00fchrt werden oder \u00fcber USB erfolgen. Beispiel f\u00fcr ein Adapterkabel mit Klinkenstecker Kenwood TM-D700 Pin Farbe TM-D700 Farbe Stecker J5 Signal bt-trx 1 o DWN -- -- 2 O -- -- -- 3 g MIC G AUDIO_OUT 4 B GND (MIC) BR -- 5 b STBY (PTT) b PTT 6 G GND BR GND 7 br 8 V, max. 200 mA br V_IN 8 BR UP -- -- Die Spannungsversorgung des bt-trx erfolgt direkt \u00fcber das Funkger\u00e4t. Beispiel f\u00fcr ein Adapterkabel f\u00fcr Kenwood TM-D700 TM-D710 Pin Farbe TM-D710 Farbe Stecker J5 Signal bt-trx 1 o Keypard Serial -- -- 2 O -- -- -- 3 g MIC (600 Ohm) G AUDIO_OUT 4 B GND (MIC) BR -- 5 b PTT b PTT 6 G GND BR GND 7 br 8 V, max. 100 mA -- -- 8 BR -- -- -- Die Spannungsversorgung des bt-trx (br (+)/BR (-)) muss extern zugef\u00fchrt werden oder \u00fcber USB erfolgen. ICOM (nicht getestet) Pin Farbe IC-7000 Farbe Stecker J5 Signal bt-trx 1 o +8 V, 10 mA max. -- -- 2 O UP/DWN -- -- 3 g M8V SW -- -- 4 B PTT b PTT 5 b GND (MIC) BR GND 6 G MIC G AUDIO_OUT 7 br GND BR GND 8 BR SQL -- -- Die Spannungsversorgung des bt-trx (br (+)/BR (-)) muss extern zugef\u00fchrt werden oder \u00fcber USB erfolgen.","title":"Anschlusskabel"},{"location":"20_Zusammenbau/Anschlusskabel/#anschlusskabel","text":"Zum Anschluss des bt-trx an das Funkger\u00e4t empfiehlt es sich, z.B. aus einem Netzwerkkabel mit RJ45 Stecker ein Adapterkabel zu bauen. Da die Funkger\u00e4te an der Mikrofonbuchse nicht immer eine passende Versorgungsspannung bzw. -leistung liefern, kann es erforderlich sein, die Spannung extern zuzuf\u00fchren (z.B. \u00fcber Zigarettenanz\u00fcnder). bt-trx bietet zwei M\u00f6glichkeiten um mit Spannung versorgt zu werden: Buchse J5: V_IN (Pin 7)/GND (Pin 8), 5...15 V DC, oder Mikro-USB Buchse des ESP32 Informationen zum Stromverbrauch gibt es hier . In den folgenden Tabellen werden immer RJ45 Stecker mit T568B Belegung angenommen!","title":"Anschlusskabel"},{"location":"20_Zusammenbau/Anschlusskabel/#belegung-rj45-buchse-j1","text":"Pin Signal bt-trx Farbe K\u00fcrzel 1 CAT_TX orange/wei\u00df o 2 AUDIO_IN_B orange O 3 CAT_RX gr\u00fcn/wei\u00df g 4 AUDIO_IN_A blau B 5 PTT blau/wei\u00df b 6 AUDIO_OUT gr\u00fcn G 7 V_IN (5...15 V DC) braun/wei\u00df br 8 GND braun BR Farbkodierung: EIA/TIA 568B","title":"Belegung RJ45 Buchse (J1)"},{"location":"20_Zusammenbau/Anschlusskabel/#belegung-funkgerat","text":"Hier ist eine Sammlung der Steckerbelegungen diverser Funkger\u00e4te und der entsprechenden Signale des bt-trx.","title":"Belegung Funkger\u00e4t"},{"location":"20_Zusammenbau/Anschlusskabel/#handfunkgerate-25mm-und-35-mm-klinke","text":"z.B. Anytone, Baofeng, Kenwood, Wouxun Kontakt Signal Farbe Stecker J5 Signal bt-trx 3.5 mm Tip +5V -- -- 3.5 mm Ring MIC+ G AUDIO_OUT 3.5 mm Sleeve MIC-/PTT b PTT 2.5 mm Tip SPK+ B AUDIO_IN_A 2.5 mm Ring Prog -- -- 2.5 mm Sleeve SPK-/PTT BR GND Die Spannungsversorgung des bt-trx (br (+)/BR (-)) muss extern zugef\u00fchrt werden oder \u00fcber USB erfolgen. Beispiel f\u00fcr ein Adapterkabel mit Klinkenstecker","title":"Handfunkger\u00e4te (2.5mm und 3.5 mm Klinke)"},{"location":"20_Zusammenbau/Anschlusskabel/#kenwood","text":"","title":"Kenwood"},{"location":"20_Zusammenbau/Anschlusskabel/#tm-d700","text":"Pin Farbe TM-D700 Farbe Stecker J5 Signal bt-trx 1 o DWN -- -- 2 O -- -- -- 3 g MIC G AUDIO_OUT 4 B GND (MIC) BR -- 5 b STBY (PTT) b PTT 6 G GND BR GND 7 br 8 V, max. 200 mA br V_IN 8 BR UP -- -- Die Spannungsversorgung des bt-trx erfolgt direkt \u00fcber das Funkger\u00e4t. Beispiel f\u00fcr ein Adapterkabel f\u00fcr Kenwood TM-D700","title":"TM-D700"},{"location":"20_Zusammenbau/Anschlusskabel/#tm-d710","text":"Pin Farbe TM-D710 Farbe Stecker J5 Signal bt-trx 1 o Keypard Serial -- -- 2 O -- -- -- 3 g MIC (600 Ohm) G AUDIO_OUT 4 B GND (MIC) BR -- 5 b PTT b PTT 6 G GND BR GND 7 br 8 V, max. 100 mA -- -- 8 BR -- -- -- Die Spannungsversorgung des bt-trx (br (+)/BR (-)) muss extern zugef\u00fchrt werden oder \u00fcber USB erfolgen.","title":"TM-D710"},{"location":"20_Zusammenbau/Anschlusskabel/#icom-nicht-getestet","text":"Pin Farbe IC-7000 Farbe Stecker J5 Signal bt-trx 1 o +8 V, 10 mA max. -- -- 2 O UP/DWN -- -- 3 g M8V SW -- -- 4 B PTT b PTT 5 b GND (MIC) BR GND 6 G MIC G AUDIO_OUT 7 br GND BR GND 8 BR SQL -- -- Die Spannungsversorgung des bt-trx (br (+)/BR (-)) muss extern zugef\u00fchrt werden oder \u00fcber USB erfolgen.","title":"ICOM (nicht getestet)"},{"location":"20_Zusammenbau/Frontblende/","text":"Frontblende","title":"Frontblende"},{"location":"20_Zusammenbau/Frontblende/#frontblende","text":"","title":"Frontblende"},{"location":"20_Zusammenbau/L\u00f6tanleitung/","text":"L\u00f6tanleitung Hinweis Die folgende L\u00f6tanleitung bezieht sich auf das bt-trx Kit (v4.1) mit vorbest\u00fcckten SMD Bauteilen. Inhalt des Kits Menge Beschreibung Bauteilnummer Hinweis 1 Vorbest\u00fcckte Platine - 1 ESP32 DevKitC U3 vorgeflashed 2 Buchsenleiste 1x19 - f\u00fcr ESP32 2 Stiftleiste 1x3 J2, J5 1 Stiftleiste 1x2 J7 1 Stiftleiste 1x4 J6 1 Klinkenbuchse 3.5mm J3 1 RJ45 Buchse J1 1 Taster SW1 1 Geh\u00e4use - 1 Jumper - 2-4 Befestigungsschrauben - Bitte pr\u00fcfen Sie ob alle o.g. Bauteile im Kit vorhanden sind. L\u00f6tvorgang Idealerweise wird mit den Stiftleisten J2 , J5 , J6 und J7 begonnen, da diese die geringste Bauh\u00f6he aufweisen Hinweise zu den Stiftleisten Die Stiftleiste J2 wird nur ben\u00f6tigt, falls ein PTT Taster nicht via Klinkenstecker verbunden werden soll, sondern direkt im Geh\u00e4use verbaut wird. Die Stiftleiste J7 wird nur ben\u00f6tigt, falls der Taster SW1 aus dem Geh\u00e4use herrausgef\u00fchrt werden soll. z.B. falls das bt-trx schwer erreichbar verbaut werden soll. Die Stiftleiste J6 ist eine optionale Herausf\u00fchrung des I2C-Bus des ESP32. Diese wird aktuell nicht verwendet und k\u00f6nnte in Zukunft z.B. f\u00fcr ein Display verwendet werden. Als n\u00e4chstes sollte der Taster SW1 aufgel\u00f6tet werden. Gefolgt von der RJ45 Buchse J1 und der Klinkenbuchse J3 . Hier sollte auf ein planes Aufliegen der Buchsen geachtet werden. Zuguterletzt folgt der ESP32 ( U3 ). Die 1x19 Buchsenleisten dienen zum einen zur Erh\u00f6hung des ESP32 um den Taster unterhalb unterzubringen, zum anderen kann der ESP zu Entwicklungszwecken aus dem bt-trx leicht entfert werden. Um den L\u00f6tvorgang so Einfach wie m\u00f6glich zu gestalten, werden die Buchsenleisten vor dem Verl\u00f6ten auf den ESP32 gesteckt und so eine senkrechte Montage gew\u00e4hrleistet. Hinweis Die USB-Buchse des ESP32 muss bei der Montage zum Platinenrand hin orientiert sein Inbetriebnahme Zur Erstinbetriebnahme wird das bt-trx Modul mit einem Micro-USB Kabel mit Strom versorgt. Nun sollten die bersteinfarbende LED (Spannungsversorgung) dauerleuchten. Montage des Geh\u00e4uses Nun wird das Modul mit den 2 beiligenden Schrauben im mitgelieferten Geh\u00e4use befestigt. Die Frontplatte muss derzeit noch manuell bearbeitet oder mit einem 3D Drucker [Link einf\u00fcgen] gefertigt werden. Nun kann, wenn noch nicht geschehen, das Anschlusskabel und der PTT-Taster gefertigt werden. Die weitere Inbetriebnahme kann nun wie hier beschrieben erfolgen.","title":"L\u00f6tanleitung"},{"location":"20_Zusammenbau/L\u00f6tanleitung/#lotanleitung","text":"Hinweis Die folgende L\u00f6tanleitung bezieht sich auf das bt-trx Kit (v4.1) mit vorbest\u00fcckten SMD Bauteilen.","title":"L\u00f6tanleitung"},{"location":"20_Zusammenbau/L\u00f6tanleitung/#inhalt-des-kits","text":"Menge Beschreibung Bauteilnummer Hinweis 1 Vorbest\u00fcckte Platine - 1 ESP32 DevKitC U3 vorgeflashed 2 Buchsenleiste 1x19 - f\u00fcr ESP32 2 Stiftleiste 1x3 J2, J5 1 Stiftleiste 1x2 J7 1 Stiftleiste 1x4 J6 1 Klinkenbuchse 3.5mm J3 1 RJ45 Buchse J1 1 Taster SW1 1 Geh\u00e4use - 1 Jumper - 2-4 Befestigungsschrauben - Bitte pr\u00fcfen Sie ob alle o.g. Bauteile im Kit vorhanden sind.","title":"Inhalt des Kits"},{"location":"20_Zusammenbau/L\u00f6tanleitung/#lotvorgang","text":"Idealerweise wird mit den Stiftleisten J2 , J5 , J6 und J7 begonnen, da diese die geringste Bauh\u00f6he aufweisen Hinweise zu den Stiftleisten Die Stiftleiste J2 wird nur ben\u00f6tigt, falls ein PTT Taster nicht via Klinkenstecker verbunden werden soll, sondern direkt im Geh\u00e4use verbaut wird. Die Stiftleiste J7 wird nur ben\u00f6tigt, falls der Taster SW1 aus dem Geh\u00e4use herrausgef\u00fchrt werden soll. z.B. falls das bt-trx schwer erreichbar verbaut werden soll. Die Stiftleiste J6 ist eine optionale Herausf\u00fchrung des I2C-Bus des ESP32. Diese wird aktuell nicht verwendet und k\u00f6nnte in Zukunft z.B. f\u00fcr ein Display verwendet werden. Als n\u00e4chstes sollte der Taster SW1 aufgel\u00f6tet werden. Gefolgt von der RJ45 Buchse J1 und der Klinkenbuchse J3 . Hier sollte auf ein planes Aufliegen der Buchsen geachtet werden. Zuguterletzt folgt der ESP32 ( U3 ). Die 1x19 Buchsenleisten dienen zum einen zur Erh\u00f6hung des ESP32 um den Taster unterhalb unterzubringen, zum anderen kann der ESP zu Entwicklungszwecken aus dem bt-trx leicht entfert werden. Um den L\u00f6tvorgang so Einfach wie m\u00f6glich zu gestalten, werden die Buchsenleisten vor dem Verl\u00f6ten auf den ESP32 gesteckt und so eine senkrechte Montage gew\u00e4hrleistet. Hinweis Die USB-Buchse des ESP32 muss bei der Montage zum Platinenrand hin orientiert sein","title":"L\u00f6tvorgang"},{"location":"20_Zusammenbau/L\u00f6tanleitung/#inbetriebnahme","text":"Zur Erstinbetriebnahme wird das bt-trx Modul mit einem Micro-USB Kabel mit Strom versorgt. Nun sollten die bersteinfarbende LED (Spannungsversorgung) dauerleuchten.","title":"Inbetriebnahme"},{"location":"20_Zusammenbau/L\u00f6tanleitung/#montage-des-gehauses","text":"Nun wird das Modul mit den 2 beiligenden Schrauben im mitgelieferten Geh\u00e4use befestigt. Die Frontplatte muss derzeit noch manuell bearbeitet oder mit einem 3D Drucker [Link einf\u00fcgen] gefertigt werden. Nun kann, wenn noch nicht geschehen, das Anschlusskabel und der PTT-Taster gefertigt werden. Die weitere Inbetriebnahme kann nun wie hier beschrieben erfolgen.","title":"Montage des Geh\u00e4uses"},{"location":"20_Zusammenbau/PTT-Taste/","text":"PTT-Taste Allgemeines Der PTT-Kontakt des Funkger\u00e4ts ist auf mehreren Wegen von bt-trx bedienbar. Soll die PTT-Taste direkt in das bt-trx Geh\u00e4use integriert werden, bietet sich J2 an. Soll die PTT-Taste an einer anderen Stelle als das bt-trx Geh\u00e4use montiert werden, wird der Anschluss an die Klinkenbuchse J3 empfohlen. Mit einem Taster und einem Klinkenstecker kann somit einfach eine f\u00fcr den jeweiligen Zweck passende PTT-Taste gebaut werden (siehe Bild weiter unten). Der \"Ring\"-Kontakt der Klinkenbuchse bzw. der mittlere Kontakt von J2 ist mit einem GPIO (3.3 V, max. 20 mA) des ESP32 verbunden, der den PTT-Status anzeigt (\"UC_PTT_LED\"). An diesen Kontakt kann eine LED (mit Vorwiderstand) angeschlossen werden, um den aktuellen PTT Status widerzuspiegeln. Der Jumper J5 muss f\u00fcr den Funkbetrieb in jedem Fall gesteckt sein. Er entscheidet, ob der PTT Taster direkt zum Transceiver durchgeschleift wird (Stellung \"BTN\", Pins 1-2 verbunden), oder ob der ESP32 das PTT Signal erzeugt (Stellung \"uC\", Pins 2-3 verbunden ). Letzteres ist notwendig, um die folgenden \"Soft-PTT\" Funktionen nutzen zu k\u00f6nnen. Soft-PTT \"Soft-PTT\" ist kurz f\u00fcr \"Software-PTT\" und beschreibt Komfort-Funktionen, die mit einer direkten Verbindung der PTT-Taste an den Transceiver nicht m\u00f6glich w\u00e4ren. Daher wird f\u00fcr Soft-PTT der ESP32 zwischen Taster und Transceiver geschaltet, damit das PTT Signal per Software gesteuert werden kann. Um die Soft-PTT Funktionen nutzen zu k\u00f6nnen, muss der Jumper J5 auf der Stellung \"uC\" sein (Pins 2-3 verbunden). Aktuell sind folgende Funktionen in der Firmware integriert: PTT wird nach Loslassen des Tasters noch f\u00fcr 500 ms gehalten Beispiel f\u00fcr eine selbstgebaute externe PTT-Taste","title":"PTT-Taste"},{"location":"20_Zusammenbau/PTT-Taste/#ptt-taste","text":"","title":"PTT-Taste"},{"location":"20_Zusammenbau/PTT-Taste/#allgemeines","text":"Der PTT-Kontakt des Funkger\u00e4ts ist auf mehreren Wegen von bt-trx bedienbar. Soll die PTT-Taste direkt in das bt-trx Geh\u00e4use integriert werden, bietet sich J2 an. Soll die PTT-Taste an einer anderen Stelle als das bt-trx Geh\u00e4use montiert werden, wird der Anschluss an die Klinkenbuchse J3 empfohlen. Mit einem Taster und einem Klinkenstecker kann somit einfach eine f\u00fcr den jeweiligen Zweck passende PTT-Taste gebaut werden (siehe Bild weiter unten). Der \"Ring\"-Kontakt der Klinkenbuchse bzw. der mittlere Kontakt von J2 ist mit einem GPIO (3.3 V, max. 20 mA) des ESP32 verbunden, der den PTT-Status anzeigt (\"UC_PTT_LED\"). An diesen Kontakt kann eine LED (mit Vorwiderstand) angeschlossen werden, um den aktuellen PTT Status widerzuspiegeln. Der Jumper J5 muss f\u00fcr den Funkbetrieb in jedem Fall gesteckt sein. Er entscheidet, ob der PTT Taster direkt zum Transceiver durchgeschleift wird (Stellung \"BTN\", Pins 1-2 verbunden), oder ob der ESP32 das PTT Signal erzeugt (Stellung \"uC\", Pins 2-3 verbunden ). Letzteres ist notwendig, um die folgenden \"Soft-PTT\" Funktionen nutzen zu k\u00f6nnen.","title":"Allgemeines"},{"location":"20_Zusammenbau/PTT-Taste/#soft-ptt","text":"\"Soft-PTT\" ist kurz f\u00fcr \"Software-PTT\" und beschreibt Komfort-Funktionen, die mit einer direkten Verbindung der PTT-Taste an den Transceiver nicht m\u00f6glich w\u00e4ren. Daher wird f\u00fcr Soft-PTT der ESP32 zwischen Taster und Transceiver geschaltet, damit das PTT Signal per Software gesteuert werden kann. Um die Soft-PTT Funktionen nutzen zu k\u00f6nnen, muss der Jumper J5 auf der Stellung \"uC\" sein (Pins 2-3 verbunden). Aktuell sind folgende Funktionen in der Firmware integriert: PTT wird nach Loslassen des Tasters noch f\u00fcr 500 ms gehalten","title":"Soft-PTT"},{"location":"20_Zusammenbau/PTT-Taste/#beispiel-fur-eine-selbstgebaute-externe-ptt-taste","text":"","title":"Beispiel f\u00fcr eine selbstgebaute externe PTT-Taste"},{"location":"30_Bedienung/Anschluss/","text":"Bedienung (Beschreibung f\u00fcr dev-board v4.1 und Firmware Version 0.2.0) 1. Anschluss von Funkger\u00e4t, Spannungsversorgung und PTT-Taste Der Anschluss ans Funkger\u00e4t erfolgt in der Regel \u00fcber ein Adapterkabel . Eine PTT-Taste kann direkt in das bt-trx Geh\u00e4use integriert (Kontakte J2), oder an die Klinkenbuchse (J3) angeschlossen werden. Hinweis zum PTT-slect Jumper J5 Bitte nicht vergessen, den Jumper zu setzen! Je nach Konfiguration auf: \u00b5C: Hier \u00fcbernimmt der ESP32 die PTT Steuerung (Empfohlen) BTN: Hier wird das PTT Signal direkt vom Taster weitergeleitet (Kann in einigen Sonderf\u00e4llen erforderlich sein) Nach dem Herstellen der Spannungsversorgung leuchtet die rote LED (zeigt 3.3 V Betriebsspannung des Controllers und des BT-Moduls an), bt-trx startet automatisch. 2. Herstellen der Bluetooth-Verbindung bt-trx beginnt nach dem Start selbstst\u00e4ndig, nach geeigneten Ger\u00e4ten f\u00fcr die Bluetoothverbindung zu suchen und eine Verbindung herzustellen. Es wird nur eine Verbindung mit Ger\u00e4ten hergestellt, die das \"HFP\"-Profil unterst\u00fctzen (Autoradios, bestimmte Headsets). Eine (ungewollte) Verbindung mit einem Smartphone kann daher nicht passieren. Info: Die Verbindung zu einfachen Bluetooth-Headsets \u00fcber das \"HSP\"-Profil wird aktuell noch nicht unterst\u00fctzt, ist aber m\u00f6glich und wird in einer der kommenden Firmware-Versionen eingebaut werden. Es kann notwendig sein, das Autoradio zum Verbindungsaufbau in den Bluetooth-Pairingmodus zu versetzen, um es f\u00fcr bt-trx sichtbar zu machen. In der Regel geschieht dies \u00fcber einen Men\u00fcpunkt \"Neues Bluetooth-Ger\u00e4t hinzuf\u00fcgen\" o.\u00e4.. Sobald die Verbindung einmal erfolgeich hergestellt wurde, sollten sich die beiden Ger\u00e4te beim n\u00e4chsten Start des bt-trx, bzw. des Fahrzeugs automatisch miteinander verbinden. Die beiden Status-LEDs (gr\u00fcn und blau) liefern folgende Informationen: Aktivit\u00e4t-LED (gr\u00fcn) Bluetooth-LED (blau) Status aus blinkt BT-Verbindungssuche aus an BT-Verbindung hergestellt blinkt an Audio-Verbindung hergestellt","title":"Anschluss"},{"location":"30_Bedienung/Anschluss/#bedienung","text":"(Beschreibung f\u00fcr dev-board v4.1 und Firmware Version 0.2.0)","title":"Bedienung"},{"location":"30_Bedienung/Anschluss/#1-anschluss-von-funkgerat-spannungsversorgung-und-ptt-taste","text":"Der Anschluss ans Funkger\u00e4t erfolgt in der Regel \u00fcber ein Adapterkabel . Eine PTT-Taste kann direkt in das bt-trx Geh\u00e4use integriert (Kontakte J2), oder an die Klinkenbuchse (J3) angeschlossen werden. Hinweis zum PTT-slect Jumper J5 Bitte nicht vergessen, den Jumper zu setzen! Je nach Konfiguration auf: \u00b5C: Hier \u00fcbernimmt der ESP32 die PTT Steuerung (Empfohlen) BTN: Hier wird das PTT Signal direkt vom Taster weitergeleitet (Kann in einigen Sonderf\u00e4llen erforderlich sein) Nach dem Herstellen der Spannungsversorgung leuchtet die rote LED (zeigt 3.3 V Betriebsspannung des Controllers und des BT-Moduls an), bt-trx startet automatisch.","title":"1. Anschluss von Funkger\u00e4t, Spannungsversorgung und PTT-Taste"},{"location":"30_Bedienung/Anschluss/#2-herstellen-der-bluetooth-verbindung","text":"bt-trx beginnt nach dem Start selbstst\u00e4ndig, nach geeigneten Ger\u00e4ten f\u00fcr die Bluetoothverbindung zu suchen und eine Verbindung herzustellen. Es wird nur eine Verbindung mit Ger\u00e4ten hergestellt, die das \"HFP\"-Profil unterst\u00fctzen (Autoradios, bestimmte Headsets). Eine (ungewollte) Verbindung mit einem Smartphone kann daher nicht passieren. Info: Die Verbindung zu einfachen Bluetooth-Headsets \u00fcber das \"HSP\"-Profil wird aktuell noch nicht unterst\u00fctzt, ist aber m\u00f6glich und wird in einer der kommenden Firmware-Versionen eingebaut werden. Es kann notwendig sein, das Autoradio zum Verbindungsaufbau in den Bluetooth-Pairingmodus zu versetzen, um es f\u00fcr bt-trx sichtbar zu machen. In der Regel geschieht dies \u00fcber einen Men\u00fcpunkt \"Neues Bluetooth-Ger\u00e4t hinzuf\u00fcgen\" o.\u00e4.. Sobald die Verbindung einmal erfolgeich hergestellt wurde, sollten sich die beiden Ger\u00e4te beim n\u00e4chsten Start des bt-trx, bzw. des Fahrzeugs automatisch miteinander verbinden. Die beiden Status-LEDs (gr\u00fcn und blau) liefern folgende Informationen: Aktivit\u00e4t-LED (gr\u00fcn) Bluetooth-LED (blau) Status aus blinkt BT-Verbindungssuche aus an BT-Verbindung hergestellt blinkt an Audio-Verbindung hergestellt","title":"2. Herstellen der Bluetooth-Verbindung"},{"location":"30_Bedienung/Firmware-Update/","text":"Firmware-Update Die aktuellste Firmwareversion kann man sich unter https://github.com/bt-trx/firmware/releases (\"bt-trx_esp32_firmware_x.y.z.bin\") herunterladen. Eine neue Firmware-Version kann mittels WLAN auf bt-trx aufgespielt werden. Daf\u00fcr muss bt-trx in den Update-Modus versetzt werden. Hierzu h\u00e4lt man SW1 w\u00e4hrend des Starts von bt-trx f\u00fcr 5 Sekunden lang gedr\u00fcckt. Wenn der Update-Modus erfolgreich gestartet wurde, blinken die beiden Status-LEDs kurz gleichzeitig. Nun kann man sich mit dem Computer oder dem Smartphone mit dem WLAN \"bt-trx\" verbinden (Password: \"bt-trx73\"). Sobald man sich verbunden hat, kann man das bt-trx Modul mit einem Browser unter http://bt-trx.local oder http://192.168.4.1 erreichen. Auf der Website muss mittels \"Choose File\" die Firmwaredatei (*.bin) ausgew\u00e4hlt und mit dem \"Update\" Button auf das Ger\u00e4t geschrieben werden. Nach erfolgreichem Upload und Einspielen des Updates startet sich bt-trx automatisch neu.","title":"Firmware-Update"},{"location":"30_Bedienung/Firmware-Update/#firmware-update","text":"Die aktuellste Firmwareversion kann man sich unter https://github.com/bt-trx/firmware/releases (\"bt-trx_esp32_firmware_x.y.z.bin\") herunterladen. Eine neue Firmware-Version kann mittels WLAN auf bt-trx aufgespielt werden. Daf\u00fcr muss bt-trx in den Update-Modus versetzt werden. Hierzu h\u00e4lt man SW1 w\u00e4hrend des Starts von bt-trx f\u00fcr 5 Sekunden lang gedr\u00fcckt. Wenn der Update-Modus erfolgreich gestartet wurde, blinken die beiden Status-LEDs kurz gleichzeitig. Nun kann man sich mit dem Computer oder dem Smartphone mit dem WLAN \"bt-trx\" verbinden (Password: \"bt-trx73\"). Sobald man sich verbunden hat, kann man das bt-trx Modul mit einem Browser unter http://bt-trx.local oder http://192.168.4.1 erreichen. Auf der Website muss mittels \"Choose File\" die Firmwaredatei (*.bin) ausgew\u00e4hlt und mit dem \"Update\" Button auf das Ger\u00e4t geschrieben werden. Nach erfolgreichem Upload und Einspielen des Updates startet sich bt-trx automatisch neu.","title":"Firmware-Update"},{"location":"30_Bedienung/Funkbetrieb/","text":"Funkbetrieb Um die Audio-Verbindung herstellen zu k\u00f6nnen, muss die Bluetooth-Verbindung (blaue LED leuchtet) hergestellt sein. Die Audioverbindung wird mittels eines simulierten Telefongespr\u00e4chs hergestellt, denn bt-trx verh\u00e4lt sich gegen\u00fcber dem Autoradio wie ein Mobiltelefon. Der Telefonanruf kann \u00fcber drei Wege hergestellt werden: T\u00e4tigen eines Anrufs an eine beliebige Rufnummer (eine Ziffer gen\u00fcgt) aus dem Telefonmen\u00fc des Autoradios heraus. bt-trx nimmt den ausgehenden Anruf automatisch an. Wichtig: Falls das Autoradio mehrere gleichzeitige Bluetooth-Verbindungen unterst\u00fctzt, muss sichergestellt werden, dass das Telefon \"bt-trx\" verwendet wird! oder Dr\u00fccken der PTT Taste oder SW1 an bt-trx. Damit wird ein eingehender Anruf simuliert, der noch am Autoradio angenommen werden muss. Nach dem Herstellen des Telefongespr\u00e4chs ist die Audioverbindung Autoradio - Funkger\u00e4t hergestellt und die gr\u00fcne LED blinkt . Nun kann durch Dr\u00fccken des PTT-Tasters auf der im Funkger\u00e4t eingestellten Frequenz gesprochen werden! Falls das Adapterkabel auch die empfangene Audio vom Funkger\u00e4t \u00fcbertr\u00e4gt, sollte diese aus den Fahrzeuglautsprechern h\u00f6rbar sein. Bei der erstmaligen Verwendung mit einem Funkger\u00e4t kann es notwendig sein, die Ein- und Ausgangsaudiopegel mit Hilfe der Lautst\u00e4rkeeinstellung des Funkger\u00e4ts und/oder auf der bt-trx Platine vorhandenen Potentiometer zu justieren. Die Audioverbindung ist aktiv, solange das Telefongespr\u00e4ch l\u00e4uft. Durch Auflegen oder Dr\u00fccken des Tasters an bt-trx wird das Gespr\u00e4ch, und somit auch die Audio-Verbindung zum Funkger\u00e4t beendet.","title":"Funkbetrieb"},{"location":"30_Bedienung/Funkbetrieb/#funkbetrieb","text":"Um die Audio-Verbindung herstellen zu k\u00f6nnen, muss die Bluetooth-Verbindung (blaue LED leuchtet) hergestellt sein. Die Audioverbindung wird mittels eines simulierten Telefongespr\u00e4chs hergestellt, denn bt-trx verh\u00e4lt sich gegen\u00fcber dem Autoradio wie ein Mobiltelefon. Der Telefonanruf kann \u00fcber drei Wege hergestellt werden: T\u00e4tigen eines Anrufs an eine beliebige Rufnummer (eine Ziffer gen\u00fcgt) aus dem Telefonmen\u00fc des Autoradios heraus. bt-trx nimmt den ausgehenden Anruf automatisch an. Wichtig: Falls das Autoradio mehrere gleichzeitige Bluetooth-Verbindungen unterst\u00fctzt, muss sichergestellt werden, dass das Telefon \"bt-trx\" verwendet wird! oder Dr\u00fccken der PTT Taste oder SW1 an bt-trx. Damit wird ein eingehender Anruf simuliert, der noch am Autoradio angenommen werden muss. Nach dem Herstellen des Telefongespr\u00e4chs ist die Audioverbindung Autoradio - Funkger\u00e4t hergestellt und die gr\u00fcne LED blinkt . Nun kann durch Dr\u00fccken des PTT-Tasters auf der im Funkger\u00e4t eingestellten Frequenz gesprochen werden! Falls das Adapterkabel auch die empfangene Audio vom Funkger\u00e4t \u00fcbertr\u00e4gt, sollte diese aus den Fahrzeuglautsprechern h\u00f6rbar sein. Bei der erstmaligen Verwendung mit einem Funkger\u00e4t kann es notwendig sein, die Ein- und Ausgangsaudiopegel mit Hilfe der Lautst\u00e4rkeeinstellung des Funkger\u00e4ts und/oder auf der bt-trx Platine vorhandenen Potentiometer zu justieren. Die Audioverbindung ist aktiv, solange das Telefongespr\u00e4ch l\u00e4uft. Durch Auflegen oder Dr\u00fccken des Tasters an bt-trx wird das Gespr\u00e4ch, und somit auch die Audio-Verbindung zum Funkger\u00e4t beendet.","title":"Funkbetrieb"},{"location":"40_Entwicklung/Hardware/","text":"Hardware Entwicklungsumgebung Der Schaltplan sowie das PCB wurden mit KiCAD (Version 5.1) enwickelt. Schaltplan und PCB Die PDF zum dev-board v4.1 k\u00f6nnen hier runtergeladen werden Schaltplan PCB Testpunkte Die folgenden Testpunkte k\u00f6nnen z.B. zum Einstellen von Pegeln verwendet werden. TP1 J1 - Audio B IN TP2 WT32i - SPK_LN TP3 WT32i - SPK_LP TP4 WT32i - MIC_LP TP5 WT32i - MIC_LN TP6 J1 - Audio OUT TP7 J1 - Audio A IN TP8 GND Trimmer RV1 Pegel Audio B IN RV2 Pegel Audio OUT (im Kit nicht best\u00fcckt!) RV3 Pegel Audio A IN L\u00f6tbr\u00fccken JP1 Enable Audio B (im Kit nicht gesetzt) JP2 Br\u00fccke wenn RV2 nicht best\u00fcckt (im Kit gesetzt) JP3 Br\u00fccke von Audio A/B zum AD Eingang ESP32 (im Kit nicht gesetzt) JP4 Enable PTT Pullup (im Kit gesetzt) Interne Sockel J2 PTT Button J5 Jumper f\u00fcr PTT OUT \u00b5C: ESP32 setzt PTT (standard) BTN: BTT Button wird direkt zum Funkger\u00e4t druchgeschleift J6 I\u00b2C Bus ESP32 (wird aktuell nicht verwendet) J7 Anschluss f\u00fcr SW1, falls dieser nach au\u00dfen gef\u00fchrt werden muss.","title":"Hardware"},{"location":"40_Entwicklung/Hardware/#hardware","text":"","title":"Hardware"},{"location":"40_Entwicklung/Hardware/#entwicklungsumgebung","text":"Der Schaltplan sowie das PCB wurden mit KiCAD (Version 5.1) enwickelt.","title":"Entwicklungsumgebung"},{"location":"40_Entwicklung/Hardware/#schaltplan-und-pcb","text":"Die PDF zum dev-board v4.1 k\u00f6nnen hier runtergeladen werden Schaltplan PCB","title":"Schaltplan und PCB"},{"location":"40_Entwicklung/Hardware/#testpunkte","text":"Die folgenden Testpunkte k\u00f6nnen z.B. zum Einstellen von Pegeln verwendet werden. TP1 J1 - Audio B IN TP2 WT32i - SPK_LN TP3 WT32i - SPK_LP TP4 WT32i - MIC_LP TP5 WT32i - MIC_LN TP6 J1 - Audio OUT TP7 J1 - Audio A IN TP8 GND","title":"Testpunkte"},{"location":"40_Entwicklung/Hardware/#trimmer","text":"RV1 Pegel Audio B IN RV2 Pegel Audio OUT (im Kit nicht best\u00fcckt!) RV3 Pegel Audio A IN","title":"Trimmer"},{"location":"40_Entwicklung/Hardware/#lotbrucken","text":"JP1 Enable Audio B (im Kit nicht gesetzt) JP2 Br\u00fccke wenn RV2 nicht best\u00fcckt (im Kit gesetzt) JP3 Br\u00fccke von Audio A/B zum AD Eingang ESP32 (im Kit nicht gesetzt) JP4 Enable PTT Pullup (im Kit gesetzt)","title":"L\u00f6tbr\u00fccken"},{"location":"40_Entwicklung/Hardware/#interne-sockel","text":"J2 PTT Button J5 Jumper f\u00fcr PTT OUT \u00b5C: ESP32 setzt PTT (standard) BTN: BTT Button wird direkt zum Funkger\u00e4t druchgeschleift J6 I\u00b2C Bus ESP32 (wird aktuell nicht verwendet) J7 Anschluss f\u00fcr SW1, falls dieser nach au\u00dfen gef\u00fchrt werden muss.","title":"Interne Sockel"},{"location":"40_Entwicklung/Software/","text":"Software Entwicklungsumgebung Die ESP32 Firmware ist in C++ mit dem Arduino-Framework geschrieben. Als Build-Umgebung wird PlatformIO verwendet (z.B. Visual Studio Code mit PlatformIO Plugin). Styleguide Es sollte sich an den Google-Styleguide f\u00fcr C++ gehalten werden. Die Code-Formatierung wird mittels clang-format automatisch gewartet: ./tools/code-style.sh src/*.cpp src/*.h Unit-Tests Die Unit-Tests f\u00fcr die Software sind mittels gtest umgesetzt. Zur Abstrahierung der Hardware-Aufrufe werden gmock Mockups verwendet. Die Tests werden mit ./test/build.sh durchgef\u00fchrt.","title":"Software"},{"location":"40_Entwicklung/Software/#software","text":"","title":"Software"},{"location":"40_Entwicklung/Software/#entwicklungsumgebung","text":"Die ESP32 Firmware ist in C++ mit dem Arduino-Framework geschrieben. Als Build-Umgebung wird PlatformIO verwendet (z.B. Visual Studio Code mit PlatformIO Plugin).","title":"Entwicklungsumgebung"},{"location":"40_Entwicklung/Software/#styleguide","text":"Es sollte sich an den Google-Styleguide f\u00fcr C++ gehalten werden. Die Code-Formatierung wird mittels clang-format automatisch gewartet: ./tools/code-style.sh src/*.cpp src/*.h","title":"Styleguide"},{"location":"40_Entwicklung/Software/#unit-tests","text":"Die Unit-Tests f\u00fcr die Software sind mittels gtest umgesetzt. Zur Abstrahierung der Hardware-Aufrufe werden gmock Mockups verwendet. Die Tests werden mit ./test/build.sh durchgef\u00fchrt.","title":"Unit-Tests"}]}